{"ast":null,"code":"/*\n * Copyright 2015 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { __assign, __decorate, __extends, __spreadArrays } from \"tslib\";\nimport classNames from \"classnames\";\nimport * as React from \"react\";\nimport DayPicker from \"react-day-picker\";\nimport { polyfill } from \"react-lifecycles-compat\";\nimport { AbstractPureComponent2, Button, DISPLAYNAME_PREFIX, Divider } from \"@blueprintjs/core\";\nimport * as Classes from \"./common/classes\";\nimport * as DateUtils from \"./common/dateUtils\";\nimport * as Errors from \"./common/errors\";\nimport { DatePickerCaption } from \"./datePickerCaption\";\nimport { getDefaultMaxDate, getDefaultMinDate } from \"./datePickerCore\";\nimport { DatePickerNavbar } from \"./datePickerNavbar\";\nimport { Shortcuts } from \"./shortcuts\";\nimport { TimePicker } from \"./timePicker\";\n\nvar DatePicker =\n/** @class */\nfunction (_super) {\n  __extends(DatePicker, _super);\n\n  function DatePicker(props, context) {\n    var _this = _super.call(this, props, context) || this;\n\n    _this.ignoreNextMonthChange = false;\n\n    _this.shouldHighlightCurrentDay = function (date) {\n      var highlightCurrentDay = _this.props.highlightCurrentDay;\n      return highlightCurrentDay && DateUtils.isToday(date);\n    };\n\n    _this.getDatePickerModifiers = function () {\n      var modifiers = _this.props.modifiers;\n      return __assign({\n        isToday: _this.shouldHighlightCurrentDay\n      }, modifiers);\n    };\n\n    _this.renderDay = function (day) {\n      var date = day.getDate();\n      return React.createElement(\"div\", {\n        className: Classes.DATEPICKER_DAY_WRAPPER\n      }, date);\n    };\n\n    _this.disabledDays = function (day) {\n      return !DateUtils.isDayInRange(day, [_this.props.minDate, _this.props.maxDate]);\n    };\n\n    _this.getDisabledDaysModifier = function () {\n      var disabledDays = _this.props.dayPickerProps.disabledDays;\n      return Array.isArray(disabledDays) ? __spreadArrays([_this.disabledDays], disabledDays) : [_this.disabledDays, disabledDays];\n    };\n\n    _this.renderCaption = function (props) {\n      return React.createElement(DatePickerCaption, __assign({}, props, {\n        maxDate: _this.props.maxDate,\n        minDate: _this.props.minDate,\n        onDateChange: _this.handleMonthChange,\n        reverseMonthAndYearMenus: _this.props.reverseMonthAndYearMenus\n      }));\n    };\n\n    _this.renderNavbar = function (props) {\n      return React.createElement(DatePickerNavbar, __assign({}, props, {\n        maxDate: _this.props.maxDate,\n        minDate: _this.props.minDate\n      }));\n    };\n\n    _this.handleDayClick = function (day, modifiers, e) {\n      var _a, _b;\n\n      (_b = (_a = _this.props.dayPickerProps).onDayClick) === null || _b === void 0 ? void 0 : _b.call(_a, day, modifiers, e);\n\n      if (modifiers.disabled) {\n        return;\n      }\n\n      _this.updateDay(day); // allow toggling selected date by clicking it again (if prop enabled)\n\n\n      var newValue = _this.props.canClearSelection && modifiers.selected ? null : DateUtils.getDateTime(day, _this.state.value);\n\n      _this.updateValue(newValue, true);\n    };\n\n    _this.handleShortcutClick = function (shortcut, selectedShortcutIndex) {\n      var _a = _this.props,\n          onShortcutChange = _a.onShortcutChange,\n          currentShortcutIndex = _a.selectedShortcutIndex;\n      var dateRange = shortcut.dateRange,\n          includeTime = shortcut.includeTime;\n      var newDate = dateRange[0];\n      var newValue = includeTime ? newDate : DateUtils.getDateTime(newDate, _this.state.value);\n\n      _this.updateDay(newDate);\n\n      _this.updateValue(newValue, true);\n\n      if (currentShortcutIndex === undefined) {\n        _this.setState({\n          selectedShortcutIndex: selectedShortcutIndex\n        });\n      }\n\n      var datePickerShortcut = __assign(__assign({}, shortcut), {\n        date: shortcut.dateRange[0]\n      });\n\n      onShortcutChange === null || onShortcutChange === void 0 ? void 0 : onShortcutChange(datePickerShortcut, selectedShortcutIndex);\n    };\n\n    _this.updateDay = function (day) {\n      if (_this.props.value === undefined) {\n        // set now if uncontrolled, otherwise they'll be updated in `componentDidUpdate`\n        _this.setState({\n          displayMonth: day.getMonth(),\n          displayYear: day.getFullYear(),\n          selectedDay: day.getDate()\n        });\n      }\n\n      if (_this.state.value != null && _this.state.value.getMonth() !== day.getMonth()) {\n        _this.ignoreNextMonthChange = true;\n      }\n    };\n\n    _this.handleClearClick = function () {\n      return _this.updateValue(null, true);\n    };\n\n    _this.handleMonthChange = function (newDate) {\n      var _a, _b;\n\n      var date = _this.computeValidDateInSpecifiedMonthYear(newDate.getFullYear(), newDate.getMonth());\n\n      _this.setState({\n        displayMonth: date.getMonth(),\n        displayYear: date.getFullYear()\n      });\n\n      if (_this.state.value !== null) {\n        // if handleDayClick just got run (so this flag is set), then the\n        // user selected a date in a new month, so don't invoke onChange a\n        // second time\n        _this.updateValue(date, false, _this.ignoreNextMonthChange);\n\n        _this.ignoreNextMonthChange = false;\n      }\n\n      (_b = (_a = _this.props.dayPickerProps).onMonthChange) === null || _b === void 0 ? void 0 : _b.call(_a, date);\n    };\n\n    _this.handleTodayClick = function () {\n      var value = new Date();\n      var displayMonth = value.getMonth();\n      var displayYear = value.getFullYear();\n      var selectedDay = value.getDate();\n\n      _this.setState({\n        displayMonth: displayMonth,\n        displayYear: displayYear,\n        selectedDay: selectedDay\n      });\n\n      _this.updateValue(value, true);\n    };\n\n    _this.handleTimeChange = function (time) {\n      var _a, _b;\n\n      (_b = (_a = _this.props.timePickerProps) === null || _a === void 0 ? void 0 : _a.onChange) === null || _b === void 0 ? void 0 : _b.call(_a, time);\n      var value = _this.state.value;\n      var newValue = DateUtils.getDateTime(value != null ? value : new Date(), time);\n\n      _this.updateValue(newValue, true);\n    };\n\n    var value = getInitialValue(props);\n    var initialMonth = getInitialMonth(props, value);\n    _this.state = {\n      displayMonth: initialMonth.getMonth(),\n      displayYear: initialMonth.getFullYear(),\n      selectedDay: value == null ? null : value.getDate(),\n      selectedShortcutIndex: _this.props.selectedShortcutIndex !== undefined ? _this.props.selectedShortcutIndex : -1,\n      value: value\n    };\n    return _this;\n  }\n\n  DatePicker.prototype.render = function () {\n    var _a;\n\n    var _b = this.props,\n        className = _b.className,\n        dayPickerProps = _b.dayPickerProps,\n        locale = _b.locale,\n        localeUtils = _b.localeUtils,\n        maxDate = _b.maxDate,\n        minDate = _b.minDate,\n        showActionsBar = _b.showActionsBar;\n    var _c = this.state,\n        displayMonth = _c.displayMonth,\n        displayYear = _c.displayYear;\n    return React.createElement(\"div\", {\n      className: classNames(Classes.DATEPICKER, className)\n    }, this.maybeRenderShortcuts(), React.createElement(\"div\", null, React.createElement(DayPicker, __assign({\n      showOutsideDays: true,\n      locale: locale,\n      localeUtils: localeUtils,\n      modifiers: this.getDatePickerModifiers()\n    }, dayPickerProps, {\n      canChangeMonth: true,\n      captionElement: this.renderCaption,\n      navbarElement: this.renderNavbar,\n      disabledDays: this.getDisabledDaysModifier(),\n      fromMonth: minDate,\n      month: new Date(displayYear, displayMonth),\n      onDayClick: this.handleDayClick,\n      onMonthChange: this.handleMonthChange,\n      selectedDays: this.state.value,\n      toMonth: maxDate,\n      renderDay: (_a = dayPickerProps === null || dayPickerProps === void 0 ? void 0 : dayPickerProps.renderDay) !== null && _a !== void 0 ? _a : this.renderDay\n    })), this.maybeRenderTimePicker(), showActionsBar && this.renderOptionsBar()));\n  };\n\n  DatePicker.prototype.componentDidUpdate = function (prevProps, prevState) {\n    _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n\n    var value = this.props.value;\n\n    if (value === prevProps.value) {\n      // no action needed\n      return;\n    } else if (value == null) {\n      // clear the value\n      this.setState({\n        value: value\n      });\n    } else {\n      this.setState({\n        displayMonth: value.getMonth(),\n        displayYear: value.getFullYear(),\n        selectedDay: value.getDate(),\n        value: value\n      });\n    }\n\n    if (this.props.selectedShortcutIndex !== prevProps.selectedShortcutIndex) {\n      this.setState({\n        selectedShortcutIndex: this.props.selectedShortcutIndex\n      });\n    }\n  };\n\n  DatePicker.prototype.validateProps = function (props) {\n    var defaultValue = props.defaultValue,\n        initialMonth = props.initialMonth,\n        maxDate = props.maxDate,\n        minDate = props.minDate,\n        value = props.value;\n\n    if (defaultValue != null && !DateUtils.isDayInRange(defaultValue, [minDate, maxDate])) {\n      console.error(Errors.DATEPICKER_DEFAULT_VALUE_INVALID);\n    }\n\n    if (initialMonth != null && !DateUtils.isMonthInRange(initialMonth, [minDate, maxDate])) {\n      console.error(Errors.DATEPICKER_INITIAL_MONTH_INVALID);\n    }\n\n    if (maxDate != null && minDate != null && maxDate < minDate && !DateUtils.areSameDay(maxDate, minDate)) {\n      console.error(Errors.DATEPICKER_MAX_DATE_INVALID);\n    }\n\n    if (value != null && !DateUtils.isDayInRange(value, [minDate, maxDate])) {\n      console.error(Errors.DATEPICKER_VALUE_INVALID);\n    }\n  };\n\n  DatePicker.prototype.renderOptionsBar = function () {\n    var _a = this.props,\n        clearButtonText = _a.clearButtonText,\n        todayButtonText = _a.todayButtonText;\n    return [React.createElement(Divider, {\n      key: \"div\"\n    }), React.createElement(\"div\", {\n      className: Classes.DATEPICKER_FOOTER,\n      key: \"footer\"\n    }, React.createElement(Button, {\n      minimal: true,\n      onClick: this.handleTodayClick,\n      text: todayButtonText\n    }), React.createElement(Button, {\n      minimal: true,\n      onClick: this.handleClearClick,\n      text: clearButtonText\n    }))];\n  };\n\n  DatePicker.prototype.maybeRenderTimePicker = function () {\n    var _a = this.props,\n        timePrecision = _a.timePrecision,\n        timePickerProps = _a.timePickerProps,\n        minDate = _a.minDate,\n        maxDate = _a.maxDate;\n\n    if (timePrecision == null && timePickerProps === undefined) {\n      return null;\n    }\n\n    var applyMin = DateUtils.areSameDay(this.state.value, minDate);\n    var applyMax = DateUtils.areSameDay(this.state.value, maxDate);\n    return React.createElement(\"div\", {\n      className: Classes.DATEPICKER_TIMEPICKER_WRAPPER\n    }, React.createElement(TimePicker, __assign({\n      precision: timePrecision,\n      minTime: applyMin ? minDate : undefined,\n      maxTime: applyMax ? maxDate : undefined\n    }, timePickerProps, {\n      onChange: this.handleTimeChange,\n      value: this.state.value\n    })));\n  };\n\n  DatePicker.prototype.maybeRenderShortcuts = function () {\n    var shortcuts = this.props.shortcuts;\n\n    if (shortcuts == null || shortcuts === false) {\n      return null;\n    }\n\n    var selectedShortcutIndex = this.state.selectedShortcutIndex;\n    var _a = this.props,\n        maxDate = _a.maxDate,\n        minDate = _a.minDate,\n        timePrecision = _a.timePrecision; // Reuse the existing date range shortcuts and only care about start date\n\n    var dateRangeShortcuts = shortcuts === true ? true : shortcuts.map(function (shortcut) {\n      return __assign(__assign({}, shortcut), {\n        dateRange: [shortcut.date, undefined]\n      });\n    });\n    return [React.createElement(Shortcuts, __assign({\n      key: \"shortcuts\"\n    }, {\n      allowSingleDayRange: true,\n      maxDate: maxDate,\n      minDate: minDate,\n      selectedShortcutIndex: selectedShortcutIndex,\n      shortcuts: dateRangeShortcuts,\n      timePrecision: timePrecision\n    }, {\n      onShortcutClick: this.handleShortcutClick,\n      useSingleDateShortcuts: true\n    })), React.createElement(Divider, {\n      key: \"div\"\n    })];\n  };\n\n  DatePicker.prototype.computeValidDateInSpecifiedMonthYear = function (displayYear, displayMonth) {\n    var _a = this.props,\n        minDate = _a.minDate,\n        maxDate = _a.maxDate;\n    var selectedDay = this.state.selectedDay; // month is 0-based, date is 1-based. date 0 is last day of previous month.\n\n    var maxDaysInMonth = new Date(displayYear, displayMonth + 1, 0).getDate();\n    var displayDate = selectedDay == null ? 1 : Math.min(selectedDay, maxDaysInMonth); // 12:00 matches the underlying react-day-picker timestamp behavior\n\n    var value = DateUtils.getDateTime(new Date(displayYear, displayMonth, displayDate, 12), this.state.value); // clamp between min and max dates\n\n    if (value < minDate) {\n      return minDate;\n    } else if (value > maxDate) {\n      return maxDate;\n    }\n\n    return value;\n  };\n  /**\n   * Update `value` by invoking `onChange` (always) and setting state (if uncontrolled).\n   */\n\n\n  DatePicker.prototype.updateValue = function (value, isUserChange, skipOnChange) {\n    var _a, _b;\n\n    if (skipOnChange === void 0) {\n      skipOnChange = false;\n    }\n\n    if (!skipOnChange) {\n      (_b = (_a = this.props).onChange) === null || _b === void 0 ? void 0 : _b.call(_a, value, isUserChange);\n    }\n\n    if (this.props.value === undefined) {\n      this.setState({\n        value: value\n      });\n    }\n  };\n\n  DatePicker.defaultProps = {\n    canClearSelection: true,\n    clearButtonText: \"Clear\",\n    dayPickerProps: {},\n    highlightCurrentDay: false,\n    maxDate: getDefaultMaxDate(),\n    minDate: getDefaultMinDate(),\n    reverseMonthAndYearMenus: false,\n    shortcuts: false,\n    showActionsBar: false,\n    todayButtonText: \"Today\"\n  };\n  DatePicker.displayName = DISPLAYNAME_PREFIX + \".DatePicker\";\n  DatePicker = __decorate([polyfill], DatePicker);\n  return DatePicker;\n}(AbstractPureComponent2);\n\nexport { DatePicker };\n\nfunction getInitialValue(props) {\n  // !== because `null` is a valid value (no date)\n  if (props.value !== undefined) {\n    return props.value;\n  }\n\n  if (props.defaultValue !== undefined) {\n    return props.defaultValue;\n  }\n\n  return null;\n}\n\nfunction getInitialMonth(props, value) {\n  var today = new Date(); // != because we must have a real `Date` to begin the calendar on.\n\n  if (props.initialMonth != null) {\n    return props.initialMonth;\n  } else if (value != null) {\n    return value;\n  } else if (DateUtils.isDayInRange(today, [props.minDate, props.maxDate])) {\n    return today;\n  } else {\n    return DateUtils.getDateBetween([props.minDate, props.maxDate]);\n  }\n}","map":{"version":3,"sources":["../../src/datePicker.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * Copyright 2015 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { __assign, __decorate, __extends, __spreadArrays } from \"tslib\";\nimport classNames from \"classnames\";\nimport * as React from \"react\";\nimport DayPicker from \"react-day-picker\";\nimport { polyfill } from \"react-lifecycles-compat\";\nimport { AbstractPureComponent2, Button, DISPLAYNAME_PREFIX, Divider } from \"@blueprintjs/core\";\nimport * as Classes from \"./common/classes\";\nimport * as DateUtils from \"./common/dateUtils\";\nimport * as Errors from \"./common/errors\";\nimport { DatePickerCaption } from \"./datePickerCaption\";\nimport { getDefaultMaxDate, getDefaultMinDate } from \"./datePickerCore\";\nimport { DatePickerNavbar } from \"./datePickerNavbar\";\nimport { Shortcuts } from \"./shortcuts\";\nimport { TimePicker } from \"./timePicker\";\nvar DatePicker = /** @class */ (function (_super) {\n    __extends(DatePicker, _super);\n    function DatePicker(props, context) {\n        var _this = _super.call(this, props, context) || this;\n        _this.ignoreNextMonthChange = false;\n        _this.shouldHighlightCurrentDay = function (date) {\n            var highlightCurrentDay = _this.props.highlightCurrentDay;\n            return highlightCurrentDay && DateUtils.isToday(date);\n        };\n        _this.getDatePickerModifiers = function () {\n            var modifiers = _this.props.modifiers;\n            return __assign({ isToday: _this.shouldHighlightCurrentDay }, modifiers);\n        };\n        _this.renderDay = function (day) {\n            var date = day.getDate();\n            return React.createElement(\"div\", { className: Classes.DATEPICKER_DAY_WRAPPER }, date);\n        };\n        _this.disabledDays = function (day) { return !DateUtils.isDayInRange(day, [_this.props.minDate, _this.props.maxDate]); };\n        _this.getDisabledDaysModifier = function () {\n            var disabledDays = _this.props.dayPickerProps.disabledDays;\n            return Array.isArray(disabledDays) ? __spreadArrays([_this.disabledDays], disabledDays) : [_this.disabledDays, disabledDays];\n        };\n        _this.renderCaption = function (props) { return (React.createElement(DatePickerCaption, __assign({}, props, { maxDate: _this.props.maxDate, minDate: _this.props.minDate, onDateChange: _this.handleMonthChange, reverseMonthAndYearMenus: _this.props.reverseMonthAndYearMenus }))); };\n        _this.renderNavbar = function (props) { return (React.createElement(DatePickerNavbar, __assign({}, props, { maxDate: _this.props.maxDate, minDate: _this.props.minDate }))); };\n        _this.handleDayClick = function (day, modifiers, e) {\n            var _a, _b;\n            (_b = (_a = _this.props.dayPickerProps).onDayClick) === null || _b === void 0 ? void 0 : _b.call(_a, day, modifiers, e);\n            if (modifiers.disabled) {\n                return;\n            }\n            _this.updateDay(day);\n            // allow toggling selected date by clicking it again (if prop enabled)\n            var newValue = _this.props.canClearSelection && modifiers.selected ? null : DateUtils.getDateTime(day, _this.state.value);\n            _this.updateValue(newValue, true);\n        };\n        _this.handleShortcutClick = function (shortcut, selectedShortcutIndex) {\n            var _a = _this.props, onShortcutChange = _a.onShortcutChange, currentShortcutIndex = _a.selectedShortcutIndex;\n            var dateRange = shortcut.dateRange, includeTime = shortcut.includeTime;\n            var newDate = dateRange[0];\n            var newValue = includeTime ? newDate : DateUtils.getDateTime(newDate, _this.state.value);\n            _this.updateDay(newDate);\n            _this.updateValue(newValue, true);\n            if (currentShortcutIndex === undefined) {\n                _this.setState({ selectedShortcutIndex: selectedShortcutIndex });\n            }\n            var datePickerShortcut = __assign(__assign({}, shortcut), { date: shortcut.dateRange[0] });\n            onShortcutChange === null || onShortcutChange === void 0 ? void 0 : onShortcutChange(datePickerShortcut, selectedShortcutIndex);\n        };\n        _this.updateDay = function (day) {\n            if (_this.props.value === undefined) {\n                // set now if uncontrolled, otherwise they'll be updated in `componentDidUpdate`\n                _this.setState({\n                    displayMonth: day.getMonth(),\n                    displayYear: day.getFullYear(),\n                    selectedDay: day.getDate(),\n                });\n            }\n            if (_this.state.value != null && _this.state.value.getMonth() !== day.getMonth()) {\n                _this.ignoreNextMonthChange = true;\n            }\n        };\n        _this.handleClearClick = function () { return _this.updateValue(null, true); };\n        _this.handleMonthChange = function (newDate) {\n            var _a, _b;\n            var date = _this.computeValidDateInSpecifiedMonthYear(newDate.getFullYear(), newDate.getMonth());\n            _this.setState({ displayMonth: date.getMonth(), displayYear: date.getFullYear() });\n            if (_this.state.value !== null) {\n                // if handleDayClick just got run (so this flag is set), then the\n                // user selected a date in a new month, so don't invoke onChange a\n                // second time\n                _this.updateValue(date, false, _this.ignoreNextMonthChange);\n                _this.ignoreNextMonthChange = false;\n            }\n            (_b = (_a = _this.props.dayPickerProps).onMonthChange) === null || _b === void 0 ? void 0 : _b.call(_a, date);\n        };\n        _this.handleTodayClick = function () {\n            var value = new Date();\n            var displayMonth = value.getMonth();\n            var displayYear = value.getFullYear();\n            var selectedDay = value.getDate();\n            _this.setState({ displayMonth: displayMonth, displayYear: displayYear, selectedDay: selectedDay });\n            _this.updateValue(value, true);\n        };\n        _this.handleTimeChange = function (time) {\n            var _a, _b;\n            (_b = (_a = _this.props.timePickerProps) === null || _a === void 0 ? void 0 : _a.onChange) === null || _b === void 0 ? void 0 : _b.call(_a, time);\n            var value = _this.state.value;\n            var newValue = DateUtils.getDateTime(value != null ? value : new Date(), time);\n            _this.updateValue(newValue, true);\n        };\n        var value = getInitialValue(props);\n        var initialMonth = getInitialMonth(props, value);\n        _this.state = {\n            displayMonth: initialMonth.getMonth(),\n            displayYear: initialMonth.getFullYear(),\n            selectedDay: value == null ? null : value.getDate(),\n            selectedShortcutIndex: _this.props.selectedShortcutIndex !== undefined ? _this.props.selectedShortcutIndex : -1,\n            value: value,\n        };\n        return _this;\n    }\n    DatePicker.prototype.render = function () {\n        var _a;\n        var _b = this.props, className = _b.className, dayPickerProps = _b.dayPickerProps, locale = _b.locale, localeUtils = _b.localeUtils, maxDate = _b.maxDate, minDate = _b.minDate, showActionsBar = _b.showActionsBar;\n        var _c = this.state, displayMonth = _c.displayMonth, displayYear = _c.displayYear;\n        return (React.createElement(\"div\", { className: classNames(Classes.DATEPICKER, className) },\n            this.maybeRenderShortcuts(),\n            React.createElement(\"div\", null,\n                React.createElement(DayPicker, __assign({ showOutsideDays: true, locale: locale, localeUtils: localeUtils, modifiers: this.getDatePickerModifiers() }, dayPickerProps, { canChangeMonth: true, captionElement: this.renderCaption, navbarElement: this.renderNavbar, disabledDays: this.getDisabledDaysModifier(), fromMonth: minDate, month: new Date(displayYear, displayMonth), onDayClick: this.handleDayClick, onMonthChange: this.handleMonthChange, selectedDays: this.state.value, toMonth: maxDate, renderDay: (_a = dayPickerProps === null || dayPickerProps === void 0 ? void 0 : dayPickerProps.renderDay) !== null && _a !== void 0 ? _a : this.renderDay })),\n                this.maybeRenderTimePicker(),\n                showActionsBar && this.renderOptionsBar())));\n    };\n    DatePicker.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        var value = this.props.value;\n        if (value === prevProps.value) {\n            // no action needed\n            return;\n        }\n        else if (value == null) {\n            // clear the value\n            this.setState({ value: value });\n        }\n        else {\n            this.setState({\n                displayMonth: value.getMonth(),\n                displayYear: value.getFullYear(),\n                selectedDay: value.getDate(),\n                value: value,\n            });\n        }\n        if (this.props.selectedShortcutIndex !== prevProps.selectedShortcutIndex) {\n            this.setState({ selectedShortcutIndex: this.props.selectedShortcutIndex });\n        }\n    };\n    DatePicker.prototype.validateProps = function (props) {\n        var defaultValue = props.defaultValue, initialMonth = props.initialMonth, maxDate = props.maxDate, minDate = props.minDate, value = props.value;\n        if (defaultValue != null && !DateUtils.isDayInRange(defaultValue, [minDate, maxDate])) {\n            console.error(Errors.DATEPICKER_DEFAULT_VALUE_INVALID);\n        }\n        if (initialMonth != null && !DateUtils.isMonthInRange(initialMonth, [minDate, maxDate])) {\n            console.error(Errors.DATEPICKER_INITIAL_MONTH_INVALID);\n        }\n        if (maxDate != null && minDate != null && maxDate < minDate && !DateUtils.areSameDay(maxDate, minDate)) {\n            console.error(Errors.DATEPICKER_MAX_DATE_INVALID);\n        }\n        if (value != null && !DateUtils.isDayInRange(value, [minDate, maxDate])) {\n            console.error(Errors.DATEPICKER_VALUE_INVALID);\n        }\n    };\n    DatePicker.prototype.renderOptionsBar = function () {\n        var _a = this.props, clearButtonText = _a.clearButtonText, todayButtonText = _a.todayButtonText;\n        return [\n            React.createElement(Divider, { key: \"div\" }),\n            React.createElement(\"div\", { className: Classes.DATEPICKER_FOOTER, key: \"footer\" },\n                React.createElement(Button, { minimal: true, onClick: this.handleTodayClick, text: todayButtonText }),\n                React.createElement(Button, { minimal: true, onClick: this.handleClearClick, text: clearButtonText })),\n        ];\n    };\n    DatePicker.prototype.maybeRenderTimePicker = function () {\n        var _a = this.props, timePrecision = _a.timePrecision, timePickerProps = _a.timePickerProps, minDate = _a.minDate, maxDate = _a.maxDate;\n        if (timePrecision == null && timePickerProps === undefined) {\n            return null;\n        }\n        var applyMin = DateUtils.areSameDay(this.state.value, minDate);\n        var applyMax = DateUtils.areSameDay(this.state.value, maxDate);\n        return (React.createElement(\"div\", { className: Classes.DATEPICKER_TIMEPICKER_WRAPPER },\n            React.createElement(TimePicker, __assign({ precision: timePrecision, minTime: applyMin ? minDate : undefined, maxTime: applyMax ? maxDate : undefined }, timePickerProps, { onChange: this.handleTimeChange, value: this.state.value }))));\n    };\n    DatePicker.prototype.maybeRenderShortcuts = function () {\n        var shortcuts = this.props.shortcuts;\n        if (shortcuts == null || shortcuts === false) {\n            return null;\n        }\n        var selectedShortcutIndex = this.state.selectedShortcutIndex;\n        var _a = this.props, maxDate = _a.maxDate, minDate = _a.minDate, timePrecision = _a.timePrecision;\n        // Reuse the existing date range shortcuts and only care about start date\n        var dateRangeShortcuts = shortcuts === true\n            ? true\n            : shortcuts.map(function (shortcut) { return (__assign(__assign({}, shortcut), { dateRange: [shortcut.date, undefined] })); });\n        return [\n            React.createElement(Shortcuts, __assign({ key: \"shortcuts\" }, {\n                allowSingleDayRange: true,\n                maxDate: maxDate,\n                minDate: minDate,\n                selectedShortcutIndex: selectedShortcutIndex,\n                shortcuts: dateRangeShortcuts,\n                timePrecision: timePrecision,\n            }, { onShortcutClick: this.handleShortcutClick, useSingleDateShortcuts: true })),\n            React.createElement(Divider, { key: \"div\" }),\n        ];\n    };\n    DatePicker.prototype.computeValidDateInSpecifiedMonthYear = function (displayYear, displayMonth) {\n        var _a = this.props, minDate = _a.minDate, maxDate = _a.maxDate;\n        var selectedDay = this.state.selectedDay;\n        // month is 0-based, date is 1-based. date 0 is last day of previous month.\n        var maxDaysInMonth = new Date(displayYear, displayMonth + 1, 0).getDate();\n        var displayDate = selectedDay == null ? 1 : Math.min(selectedDay, maxDaysInMonth);\n        // 12:00 matches the underlying react-day-picker timestamp behavior\n        var value = DateUtils.getDateTime(new Date(displayYear, displayMonth, displayDate, 12), this.state.value);\n        // clamp between min and max dates\n        if (value < minDate) {\n            return minDate;\n        }\n        else if (value > maxDate) {\n            return maxDate;\n        }\n        return value;\n    };\n    /**\n     * Update `value` by invoking `onChange` (always) and setting state (if uncontrolled).\n     */\n    DatePicker.prototype.updateValue = function (value, isUserChange, skipOnChange) {\n        var _a, _b;\n        if (skipOnChange === void 0) { skipOnChange = false; }\n        if (!skipOnChange) {\n            (_b = (_a = this.props).onChange) === null || _b === void 0 ? void 0 : _b.call(_a, value, isUserChange);\n        }\n        if (this.props.value === undefined) {\n            this.setState({ value: value });\n        }\n    };\n    DatePicker.defaultProps = {\n        canClearSelection: true,\n        clearButtonText: \"Clear\",\n        dayPickerProps: {},\n        highlightCurrentDay: false,\n        maxDate: getDefaultMaxDate(),\n        minDate: getDefaultMinDate(),\n        reverseMonthAndYearMenus: false,\n        shortcuts: false,\n        showActionsBar: false,\n        todayButtonText: \"Today\",\n    };\n    DatePicker.displayName = DISPLAYNAME_PREFIX + \".DatePicker\";\n    DatePicker = __decorate([\n        polyfill\n    ], DatePicker);\n    return DatePicker;\n}(AbstractPureComponent2));\nexport { DatePicker };\nfunction getInitialValue(props) {\n    // !== because `null` is a valid value (no date)\n    if (props.value !== undefined) {\n        return props.value;\n    }\n    if (props.defaultValue !== undefined) {\n        return props.defaultValue;\n    }\n    return null;\n}\nfunction getInitialMonth(props, value) {\n    var today = new Date();\n    // != because we must have a real `Date` to begin the calendar on.\n    if (props.initialMonth != null) {\n        return props.initialMonth;\n    }\n    else if (value != null) {\n        return value;\n    }\n    else if (DateUtils.isDayInRange(today, [props.minDate, props.maxDate])) {\n        return today;\n    }\n    else {\n        return DateUtils.getDateBetween([props.minDate, props.maxDate]);\n    }\n}\n//# sourceMappingURL=datePicker.js.map"]},"metadata":{},"sourceType":"module"}